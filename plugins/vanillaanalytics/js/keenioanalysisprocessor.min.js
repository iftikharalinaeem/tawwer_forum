KeenIOAnalysesProcessor=function(a){this.processInstructions={},this.finalAnalysis=null,this.process=function(a){var b=this,c={},d=!0;return $.each(this.processInstructions,function(e,f){var g=[];return $.each(f.analyses,function(b,d){if(Number.isInteger(d))g.push(a[d]);else{if("undefined"==typeof c[d])throw"Invalid processed query name";g.push(c[d])}}),c[e]=b[f.processor](g),"undefined"!=typeof f.title&&(c[e].title=f.title),"undefined"!=typeof f.validators&&$.each(f.validators,function(a,f){if("function"!=typeof b[a])throw'Invalid validation callback "'+a+'"';return $.each(f,function(f,g){var h=[c[e]];return Array.isArray(g)&&(h=h.concat(g)),d=b[a].apply(b,h)}),d}),d}),!!d&&c[this.finalAnalysis]},this.loadConfig(a)},KeenIOAnalysesProcessor.prototype.loadConfig=function(a){if("object"!=typeof a)throw"Invalid KeenIOAnalysesProcessor config";if("undefined"==typeof a.instructions)throw"Missing process in KeenIOAnalysesProcessor config";if("undefined"==typeof a.finalAnalysis)throw"Missing finalAnalysis in KeenIOAnalysesProcessor config";this.processInstructions=a.instructions,this.finalAnalysis=a.finalAnalysis},KeenIOAnalysesProcessor.prototype.walkAnalysis=function(a,b){var c=this;~function d(a,b,e){var f=!0;return null!==a&&(f=e.call(c,a,b)),(f!==!1&&Array.isArray(b)||$.isPlainObject(b))&&$.each(b,function(a,b){return f=d(a,b,e),f!==!1}),f!==!1}(null,a.result||a,b)},KeenIOAnalysesProcessor.prototype.validateResultsNotEmptyish=function(a){var b=!0;return this.walkAnalysis(a,function(a,c){if("result"===a){if("number"!=typeof c||0===c)throw"Unhandled case!";return b=!1}}),!b},KeenIOAnalysesProcessor.prototype.validatePropertyValueExisting=function(a,b,c){var d=!1;return this.walkAnalysis(a,function(a,e){return a===b&&e===c&&(d=!0),!d}),d},KeenIOAnalysesProcessor.prototype.noop=function(a){return a},KeenIOAnalysesProcessor.prototype.addResults=function(a){if(!Array.isArray(a)||a.length<2)throw"addResults requires an array of results";var b="singleValue";Array.isArray(a[0].result)&&(b="multipleValue");var c=a.shift();return $.each(a,function(a,d){"singleValue"===b?c.result+=d.result:$.each(d.result,function(a,b){c.result[a].value+=b.value})}),c},KeenIOAnalysesProcessor.prototype.substractResults=function(a){if(!Array.isArray(a)||a.length<2)throw"substractResults requires an array of results";var b="singleValue";Array.isArray(a[0].result)&&(b="multipleValue");var c=a.shift();return $.each(a,function(a,d){"singleValue"===b?c.result-=d.result:$.each(d.result,function(a,b){c.result[a].value-=b.value})}),c},KeenIOAnalysesProcessor.prototype.divideResults=function(a){if(!Array.isArray(a)||a.length<2)throw"divideResults requires an array of results";var b="singleValue";Array.isArray(a[0].result)&&(b="multipleValue");var c=a.shift();return $.each(a,function(a,d){"singleValue"===b?0!=d.result?c.result/=d.result:c.result=0:$.each(d.result,function(a,b){0!=b.value?c.result[a].value/=b.value:c.result[a].value=0})}),c},KeenIOAnalysesProcessor.prototype.mergeResults=function(a){if(!Array.isArray(a)||a.length<2)throw"mergeResults requires an array of results";var b={result:[]};return $.each(a,function(a,c){b.result.push(c)}),b};
//# sourceMappingURL=keenioanalysisprocessor.min.js.map