function KeenIOWidget(t,e,i,n,r){this.client=null,this.config=i||{},this.chartConfig=this.config.chart||{},this.query=[],this.type=n||"",this.title=r||"","object"==typeof e&&e instanceof Date?this.rangeEnd=e:(this.rangeEnd=new Date,this.rangeEnd.setHours(0,0,0)),"object"==typeof t&&t instanceof Date?this.rangeStart=t:(this.rangeStart=new Date,this.rangeStart.setHours(0,0,0),this.rangeStart.setMonth(e.getMonth()-1)),this.addQuery(this.config.query||{})}KeenIOWidget.prototype.addQuery=function(t,e){if(t instanceof Array)for(i in t)this.addQuery(t[i]);else if("object"==typeof t){var n,r={start:this.rangeStart.toISOString(),end:this.rangeEnd.toISOString()};if(this.query.length>0&&"undefined"!=typeof this.query[0]){var a=this.query[0],o=a.params||{};n=o.interval||null}else n=t.interval||null;var s={eventCollection:t.eventCollection||null,filters:t.filters||[],interval:n,maxAge:86400,timeframe:r};"undefined"!=typeof t.groupBy&&(s.groupBy=t.groupBy),"undefined"!=typeof t.target_property&&(s.target_property=t.target_property);var h=new Keen.Query(t.analisysType||null,s);h.title=t.title||null,this.query.push(h)}},KeenIOWidget.prototype.getClient=function(){if(!this.client&&"function"==typeof Keen){var t=gdn.meta["keenio.projectID"]||!1,e=gdn.meta["keenio.readKey"]||!1;this.client=new Keen({projectId:t,readKey:e})}return this.client},KeenIOWidget.prototype.writeContents=function(t){var e,i=this.getClient();if("object"==typeof i){e=Array.isArray(this.query)?this.query.shift():this.query;var n;switch(this.type.toLowerCase()){case"metric":n={colors:["transparent"]};break;default:n={library:"c3"}}jQuery.extend(!0,n,this.chartConfig),i.draw(e,t,n)}};