function KeenIOWidget(t,e,i,r,n){this.client=null,this.config=i||{},this.chartConfig=this.config.chart||{},this.query=[],this.type=r||"",this.title=n||"","object"==typeof e&&e instanceof Date?this.rangeEnd=e:(this.rangeEnd=new Date,this.rangeEnd.setHours(0,0,0)),"object"==typeof t&&t instanceof Date?this.rangeStart=t:(this.rangeStart=new Date,this.rangeStart.setHours(0,0,0),this.rangeStart.setMonth(e.getMonth()-1)),this.addQuery(this.config.query||{})}KeenIOWidget.prototype.addQuery=function(t,e){if(t instanceof Array)for(i in t)this.addQuery(t[i]);else if("object"==typeof t){var r,n={start:this.rangeStart.toISOString(),end:this.rangeEnd.toISOString()};if(this.query.length>0&&"undefined"!=typeof this.query[0]){var a=this.query[0],o=a.params||{};r=o.interval||null}else r=t.interval||null;var s={eventCollection:t.eventCollection||null,filters:t.filters||[],interval:r,maxAge:86400,timeframe:n};"undefined"!=typeof t.groupBy&&(s.groupBy=t.groupBy),"undefined"!=typeof t.target_property&&(s.target_property=t.target_property);var y=new Keen.Query(t.analisysType||null,s);y.title=t.title||null,this.query.push(y)}},KeenIOWidget.prototype.getClient=function(){if(!this.client&&"function"==typeof Keen){var t=gdn.meta["keenio.projectID"]||!1,e=gdn.meta["keenio.readKey"]||!1;this.client=new Keen({projectId:t,readKey:e})}return this.client},KeenIOWidget.prototype.write=function(t){if("object"==typeof t){var e,i=this.getClient();if("object"==typeof i){e=Array.isArray(this.query)?this.query.shift():this.query;var r;switch(this.type.toLowerCase()){case"metric":r={colors:["transparent"]};break;default:r={library:"c3"}}jQuery.extend(!0,r,this.chartConfig),i.draw(e,t,r)}}};