var analyticsToolbar={inited:!1,minTicks:2,maxTicks:200,getDefaultRange:function(){var a=Cookies.getJSON("va-dateRange"),b=/\d{4}-\d\d-\d\dT(\d\d:){2}\d\d.\d{3}(\+|-)\d\d:\d\d/;return a="object"==typeof a&&"string"==typeof a.start&&"string"==typeof a.end&&b.test(a.start)?{start:a.start,end:a.end}:{start:moment().startOf("day").subtract(1,"month").format("YYYY-MM-DDTHH:mm:ss.SSSZ"),end:moment().startOf("day").format("YYYY-MM-DDTHH:mm:ss.SSSZ")}},setWidgets:function(a,b){var c=[window.analyticsDashboard.getPanel("metrics"),window.analyticsDashboard.getPanel("charts")];for(var d in c){panel=c[d];for(var e in panel.widgets)widget=panel.widgets[e],"function"==typeof widget[a]&&(valid=widget[a].apply(widget,b),window.analyticsToolbar.inited&&valid!==!1&&widget.render())}},updateIntervals:function(a){var b=Cookies.getJSON("va-interval"),c=new Date(a.end),d=new Date(a.start),e=(c-d)/1e3;e||(e=86400);var f=e/analyticsToolbar.maxTicks,g=e/analyticsToolbar.minTicks;$(".js-analytics-interval").each(function(){$(this).data("seconds")<=f||$(this).data("seconds")>=g?$(this).addClass("disabled"):$(this).removeClass("disabled")});var h=$('.js-analytics-interval[data-interval="'+b+'"]');"undefined"!==b&&h.length>0&&!h.hasClass("disabled")?h.trigger("click"):($(".js-analytics-interval.active").hasClass("disabled")||0===$(".js-analytics-interval.active").length)&&($(".js-analytics-interval.active").removeClass("active"),$(".js-analytics-interval").each(function(){if(!$(this).hasClass("disabled"))return $(this).trigger("click"),!1}))}};$(document).on("click",".js-analytics-interval:not(.disabled)",function(){if(!$(this).hasClass("active")){$(".js-analytics-interval").removeClass("active"),$(this).addClass("active"),Cookies.set("va-interval",$(this).data("interval"));var a=$(this).data("interval");analyticsToolbar.setWidgets("setInterval",[a])}}),$(document).ready(function(){var a=analyticsToolbar.getDefaultRange(),b=moment().startOf("day").add(1,"day");$(".js-date-range").daterangepicker({alwaysShowCalendars:!0,startDate:moment(a.start),endDate:moment(a.end),opens:"left",buttonClasses:"btn",applyClass:"btn-primary",cancelClass:"btn-secondary",maxDate:b,ranges:{"Past 30 Days":[moment().startOf("day").subtract(29,"days"),b],"This Month":[moment().startOf("month"),b],"Last Month":[moment().startOf("month").subtract(1,"month"),moment().startOf("month")],"Past Year":[moment().startOf("day").subtract(1,"year"),b],"Year to Date":[moment().startOf("year"),b]}}),$(".js-date-range").on("apply.daterangepicker",function(a,b){var c;c=b.startDate.format("Z")===b.endDate.format("Z")?b.startDate.format("Z"):moment("2016-01-01").format("Z");var d={start:b.startDate.format("YYYY-MM-DDT00:00:00.000")+c,end:b.endDate.format("YYYY-MM-DDT00:00:00.000")+c};Cookies.set("va-dateRange",d),analyticsToolbar.updateIntervals(d),analyticsToolbar.setWidgets("setRange",[d])}),$(".js-date-range").on("show.daterangepicker",function(a,b){$(".daterangepicker").css("display","flex")}),analyticsToolbar.updateIntervals(a),analyticsToolbar.inited=!0,analyticsToolbar.setWidgets("setRange",[a]),$(".Section-Analytics").on("change",".js-category-telescope",function(){var a=$(this),b=a.val(),c=a.data("depth"),d=!0;for(a.prop("disabled",!0);""===b;)b=$(".js-category-telescope[data-depth="+(c-1)+"]").val(),d=!1;if(void 0===b&&(b=""),a.parent().nextAll(".js-category-telescope-wrapper").remove(),analyticsToolbar.setWidgets("setFilter",["categoryAncestors.cat01.categoryID",b,"cat01"]),!d)return void a.prop("disabled",!1);var e={DeliveryType:"VIEW",DeliveryMethod:"JSON",ParentCategoryID:b,ParentDepth:c,TransientKey:gdn.definition("TransientKey")};$.ajax({type:"POST",data:e,url:gdn.url("/analytics/getcategorydropdown"),dataType:"html",error:function(a){console.error(a.responseText)},success:function(b){a.parents(".js-filter-content").appendTrigger(b)},complete:function(){a.prop("disabled",!1)}})})});
//# sourceMappingURL=analyticstoolbar.min.js.map