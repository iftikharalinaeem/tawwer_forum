function AnalyticsDashboard(t,e,i){this.dashboardID="",this.panels={},this.timeframe={end:new Date,start:new Date},this.title="",e instanceof Date&&i instanceof Date?this.setTimeframe(e,i):(this.timeframe.start.setHours(0,0,0),this.timeframe.start.setMonth(this.timeframe.end.getMonth()-1)),this.loadConfig(t)}AnalyticsDashboard.prototype.addPanel=function(t,e){return"object"==typeof e?(this.panels[t]=e,!0):!1},AnalyticsDashboard.prototype.clearPanel=function(t){var e="analytics_panel_"+t,a=document.getElementById(e);if("object"!=typeof a)return!1;if(a.hasChildNodes())for(i=0;i<a.childNodes.length;i++)a.removeChild(a.childNodes[i]);return!0},AnalyticsDashboard.prototype.getPanel=function(t){return"undefined"==typeof t?this.panels:this.panels[t]||!1},AnalyticsDashboard.prototype.loadConfig=function(t){if("object"==typeof t){if("undefined"!=typeof t.dashboardID&&(this.dashboardID=t.dashboardID),"object"==typeof t.panels){this.panels={};var e,a=Object.getOwnPropertyNames(t.panels);for(i=0;i<a.length;i++)e=a[i],this.addPanel(e,t.panels[e])}"string"==typeof t.title&&(this.title=t.title)}},AnalyticsDashboard.prototype.setTimeframe=function(t,e){if("object"!=typeof t||!(t instanceof Date))throw"Invalid start date";if("object"!=typeof e||!(e instanceof Date))throw"Invalid end date";if(t>=e)throw"Invalid date range. Start equals or surpasses end.";this.range.start=t,this.range.end=e},AnalyticsDashboard.prototype.writeDashboard=function(){for(var t in this.getPanel())this.clearPanel(t),this.writePanel(t)},AnalyticsDashboard.prototype.writePanel=function(t){var e=this.getPanel(t);if(e===!1)throw"Invalid panel: "+t;var a="analytics_panel_"+t,n=document.getElementById(a);if("object"!=typeof n)throw"Unable to find container: #"+a;if("undefined"==typeof e.widgets||!Array.isArray(e.widgets))throw"Panel does not contain a widget array.";for(i=0;i<e.widgets.length;i++)this.writeWidget(e.widgets[i],n)},AnalyticsDashboard.prototype.writeWidget=function(t,e){if("object"!=typeof t)throw"Invalid widget config";if("object"!=typeof e)throw"Invalid widget container.";var i=t.data||[],a=t.handler||!1,n=t.title||"",o=t.type||!1,r=t.widgetID||!1;if("function"!=typeof window[a])throw"Failed to locate handler: "+a;if(a||r||o){var s=document.createElement("div");if(s.setAttribute("id","analytics_widget_"+r),s.setAttribute("class","analytics-widget analytics-widget-"+o),"metric"!==o){var d=document.createElement("h4");d.setAttribute("class","title"),d.innerHTML=n,s.appendChild(d)}var l=document.createElement("div"),h=new window[a](this.timeframe.start,this.timeframe.end,i,o,n);l.setAttribute("class","body"),h.writeContents(l),s.appendChild(l),e.appendChild(s)}};