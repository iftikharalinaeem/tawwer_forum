function AnalyticsDashboard(t,e,n,i){var a=null,o="",r={},s={end:new Date,start:new Date},d="";this.addPanel=function(t,e){return"object"==typeof e?r[t]=e:!1},this.getCategoryID=function(){return a},this.getDashboardID=function(){return o},this.getPanel=function(t){return"undefined"==typeof t?r:r[t]||!1},this.getTimeframe=function(){return s},this.getTitle=function(){return d},this.resetPanels=function(t){if(t===!0)for(var e in this.getPanel())this.emptyPanelContainer(e);return r={}},this.setCategoryID=function(t){return"undefined"==typeof t?!1:void(this.categoryID=null===t?null:parseInt(t))},this.setDashboardID=function(t){return"string"!=typeof t&&"number"!=typeof t?!1:o=t},this.setTimeframe=function(t,e){if("object"!=typeof t||!(t instanceof Date))throw"Invalid start date";if("object"!=typeof e||!(e instanceof Date))throw"Invalid end date";if(t>=e)throw"Invalid date range. Start equals or surpasses end.";return s.start=t,s.end=e,s},this.setTitle=function(t){return"string"!=typeof t?!1:d=t},s.start.setHours(0,0,0),s.start.setMonth(s.end.getMonth()-1),e instanceof Date&&n instanceof Date&&this.setTimeframe(e,n),"undefined"!=typeof i&&this.setCategoryID(i),this.loadConfig(t)}AnalyticsDashboard.prototype.emptyPanelContainer=function(t){var e="analytics_panel_"+t,n=document.getElementById(e);if("object"!=typeof n)return!1;if(n.hasChildNodes())for(i=0;i<n.childNodes.length;i++)n.removeChild(n.childNodes[i]);return!0},AnalyticsDashboard.prototype.loadConfig=function(t){if("object"==typeof t){if("undefined"!=typeof t.dashboardID&&this.setDashboardID(t.dashboardID),"object"==typeof t.panels){var e,n=Object.getOwnPropertyNames(t.panels);this.resetPanels();for(var i=0;i<n.length;i++)e=n[i],this.addPanel(e,t.panels[e])}"string"==typeof t.title&&this.setTitle(t.title)}},AnalyticsDashboard.prototype.writeDashboard=function(){for(var t in this.getPanel())this.emptyPanelContainer(t),this.writePanel(t)},AnalyticsDashboard.prototype.writePanel=function(t){var e=this.getPanel(t);if(e===!1)throw"Invalid panel: "+t;var n="analytics_panel_"+t,i=document.getElementById(n);if("object"!=typeof i)throw"Unable to find container: #"+n;if("undefined"==typeof e.widgets||!Array.isArray(e.widgets))throw"Panel does not contain a widget array.";for(var a=0;a<e.widgets.length;a++)this.writeWidget(e.widgets[a],i)},AnalyticsDashboard.prototype.writeWidget=function(t,e){if("object"!=typeof t)throw"Invalid widget config";if("object"!=typeof e)throw"Invalid widget container.";var n=t.data||[],i=t.handler||!1,a=t.title||"",o=t.type||!1,r=t.widgetID||!1,s=this.getTimeframe();if("function"!=typeof window[i])throw"Failed to locate handler: "+i;if(i||r||o){var d=new window[i](s.start,s.end,n,o,a),l={body:document.createElement("div"),container:document.createElement("div"),title:document.createElement("h4")};l.container.setAttribute("id","analytics_widget_"+r),l.container.setAttribute("class","analytics-widget analytics-widget-"+o),"metric"!==o&&(l.title.setAttribute("class","title"),l.title.innerHTML=a,l.container.appendChild(l.title)),l.body.setAttribute("class","body"),d.writeContents(l.body),l.container.appendChild(l.body),e.appendChild(l.container)}};